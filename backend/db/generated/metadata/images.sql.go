// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: images.sql

package metadata

import (
	"context"
	"database/sql"
)

const createImage = `-- name: CreateImage :exec
INSERT INTO images (
    id, filename, mime_type_id, thumbnail, hash, created_at, edited_at
) VALUES (
    ?, ?, ?, ?, ?, ?, ?
)
`

type CreateImageParams struct {
	ID         string
	Filename   string
	MimeTypeID int64
	Thumbnail  []byte
	Hash       string
	CreatedAt  sql.NullTime
	EditedAt   sql.NullTime
}

func (q *Queries) CreateImage(ctx context.Context, arg CreateImageParams) error {
	_, err := q.db.ExecContext(ctx, createImage,
		arg.ID,
		arg.Filename,
		arg.MimeTypeID,
		arg.Thumbnail,
		arg.Hash,
		arg.CreatedAt,
		arg.EditedAt,
	)
	return err
}

const deleteImage = `-- name: DeleteImage :exec
DELETE FROM images
WHERE id = ?
`

func (q *Queries) DeleteImage(ctx context.Context, id string) error {
	_, err := q.db.ExecContext(ctx, deleteImage, id)
	return err
}

const getImageByHash = `-- name: GetImageByHash :one
SELECT
    id, filename, mime_type_id, thumbnail, hash, created_at, edited_at
FROM images
WHERE hash = ?
`

func (q *Queries) GetImageByHash(ctx context.Context, hash string) (Image, error) {
	row := q.db.QueryRowContext(ctx, getImageByHash, hash)
	var i Image
	err := row.Scan(
		&i.ID,
		&i.Filename,
		&i.MimeTypeID,
		&i.Thumbnail,
		&i.Hash,
		&i.CreatedAt,
		&i.EditedAt,
	)
	return i, err
}

const getImageByID = `-- name: GetImageByID :one
SELECT
    id, filename, mime_type_id, thumbnail, hash, created_at, edited_at
FROM images
WHERE id = ?
`

func (q *Queries) GetImageByID(ctx context.Context, id string) (Image, error) {
	row := q.db.QueryRowContext(ctx, getImageByID, id)
	var i Image
	err := row.Scan(
		&i.ID,
		&i.Filename,
		&i.MimeTypeID,
		&i.Thumbnail,
		&i.Hash,
		&i.CreatedAt,
		&i.EditedAt,
	)
	return i, err
}

const listImages = `-- name: ListImages :many
SELECT
    images.id,
    images.filename,
    images.mime_type_id,
    mime_types.mime,
    images.thumbnail,
    images.hash,
    images.created_at,
    images.edited_at
FROM images
JOIN mime_types ON images.mime_type_id = mime_types.id
ORDER BY images.created_at DESC
`

type ListImagesRow struct {
	ID         string
	Filename   string
	MimeTypeID int64
	Mime       string
	Thumbnail  []byte
	Hash       string
	CreatedAt  sql.NullTime
	EditedAt   sql.NullTime
}

func (q *Queries) ListImages(ctx context.Context) ([]ListImagesRow, error) {
	rows, err := q.db.QueryContext(ctx, listImages)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListImagesRow
	for rows.Next() {
		var i ListImagesRow
		if err := rows.Scan(
			&i.ID,
			&i.Filename,
			&i.MimeTypeID,
			&i.Mime,
			&i.Thumbnail,
			&i.Hash,
			&i.CreatedAt,
			&i.EditedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateImageMetadata = `-- name: UpdateImageMetadata :exec
UPDATE images
SET filename = ?, mime_type_id = ?, edited_at = ?
WHERE id = ?
`

type UpdateImageMetadataParams struct {
	Filename   string
	MimeTypeID int64
	EditedAt   sql.NullTime
	ID         string
}

func (q *Queries) UpdateImageMetadata(ctx context.Context, arg UpdateImageMetadataParams) error {
	_, err := q.db.ExecContext(ctx, updateImageMetadata,
		arg.Filename,
		arg.MimeTypeID,
		arg.EditedAt,
		arg.ID,
	)
	return err
}
